{"version":3,"sources":["../../../lib/compiler/compiler.js"],"names":["t","require","c","options","PathExpression","path","iterPattern","paths","split","reduce","prev","key","matches","match","rest","index","stringLiteral","KEY_I","Guard","unsafe","out","p","memberExpression","CONTEXT","last","callExpression","GUARD","logicalExpression","ConcatStringList","outputs","i","length","binaryExpression","UnsafeIter","branch","iterSuffix","arr","identifier","output","functionExpression","blockStatement","variableDeclaration","variableDeclarator","subject","LENGTH","INDEX","numericLiteral","KEY","forStatement","updateExpression","expressionStatement","assignmentExpression","compile","body","returnStatement","transforms","StringLiteral","value","SimpleExpression","HelperExpression","HELPERS","helperName","args","HELPER","arrayExpression","OpenIf","nextBranch","test","tokenType","not","unaryExpression","alternate","skipThis","conditionalExpression","OpenIter","name","cleanName","iter","ITER","EACH","Text","RawMustache","expression","raw","EscapedMustache","ESCAPE","compiled","len","push","slice","compiler","parsed","opts","functionDeclaration","COMPILED","runtimeParams","module","exports"],"mappings":"AAAA;;AAEA,MAAMA,CAAC,GAAGC,OAAO,CAAC,aAAD,CAAjB;;AAEA,MAAMC,CAAC,GAAGD,OAAO,CAAC,aAAD,CAAjB;;AAEA,IAAIE,OAAJ,C,CAEA;;AACA,SAASC,cAAT,CAAwBC,IAAxB,EAA8B;AAC5B,QAAMC,WAAW,GAAG,gBAApB;AACA,QAAMC,KAAK,GAAGF,IAAI,CAACG,KAAL,CAAW,GAAX,EAAgBC,MAAhB,CAAuB,CAACC,IAAD,EAAOC,GAAP,KAAe;AAClD,UAAMC,OAAO,GAAGD,GAAG,CAACE,KAAJ,CAAUP,WAAV,CAAhB;;AACA,QAAIM,OAAJ,EAAa;AACX,YAAM,GAAGE,IAAH,EAASC,KAAT,IAAkBH,OAAxB;AACA,aAAO,CAAC,GAAGF,IAAJ,EAAUV,CAAC,CAACgB,aAAF,CAAgBF,IAAhB,CAAV,EAAiCZ,CAAC,CAACe,KAAF,CAAQF,KAAR,CAAjC,CAAP;AACD;;AACD,WAAO,CAAC,GAAGL,IAAJ,EAAUV,CAAC,CAACgB,aAAF,CAAgBL,GAAhB,CAAV,CAAP;AACD,GAPa,EAOX,EAPW,CAAd;AASA,SAAOJ,KAAP;AACD;;AACD,SAASW,KAAT,CAAeb,IAAf,EAAqB;AACnB,QAAME,KAAK,GAAGH,cAAc,CAACC,IAAD,CAA5B;;AAEA,MAAIF,OAAO,CAACgB,MAAR,KAAmB,IAAvB,EAA6B;AAC3B,WAAOZ,KAAK,CAACE,MAAN,CAAa,CAACW,GAAD,EAAMC,CAAN,KAAYrB,CAAC,CAACsB,gBAAF,CAAmBF,GAAnB,EAAwBC,CAAxB,EAA2B,IAA3B,CAAzB,EAA2DnB,CAAC,CAACqB,OAA7D,CAAP;AACD,GALkB,CAOnB;AACA;;;AACA,MAAIC,IAAI,GAAGtB,CAAC,CAACqB,OAAb;AACA,SAAOvB,CAAC,CAACyB,cAAF,CAAiBvB,CAAC,CAACwB,KAAnB,EAA0B,CAC/BnB,KAAK,CAACE,MAAN,CAAa,CAACW,GAAD,EAAMC,CAAN,KAAY;AACvBG,IAAAA,IAAI,GAAGxB,CAAC,CAACsB,gBAAF,CAAmBE,IAAnB,EAAyBH,CAAzB,EAA4B,IAA5B,CAAP;AACA,WAAOrB,CAAC,CAAC2B,iBAAF,CAAoB,IAApB,EAA0BP,GAA1B,EAA+BI,IAA/B,CAAP;AACD,GAHD,EAGGA,IAHH,CAD+B,CAA1B,CAAP;AAMD,C,CACD;AACA;AACA;;;AACA,SAASI,gBAAT,CAA0BC,OAA1B,EAAmC;AACjC,MAAIT,GAAG,GAAGS,OAAO,CAAC,CAAD,CAAjB;;AAEA,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,OAAO,CAACE,MAA5B,EAAoCD,CAAC,IAAI,CAAzC,EAA4C;AAC1CV,IAAAA,GAAG,GAAGpB,CAAC,CAACgC,gBAAF,CAAmB,GAAnB,EAAwBZ,GAAxB,EAA6BS,OAAO,CAACC,CAAD,CAApC,CAAN;AACD;;AAED,SAAOV,GAAP;AACD,C,CACD;AACA;;;AACA,SAASa,UAAT,CAAoBC,MAApB,EAA4B;AAC1B,QAAMvB,GAAG,GAAGT,CAAC,CAACe,KAAF,CAAQiB,MAAM,CAACC,UAAf,CAAZ;AAEA,QAAMC,GAAG,GAAGpC,CAAC,CAACqC,UAAF,CAAa,KAAb,CAAZ;AACA,QAAMC,MAAM,GAAGtC,CAAC,CAACqC,UAAF,CAAa,QAAb,CAAf;AAEA,SAAOrC,CAAC,CAACyB,cAAF,CAAiBzB,CAAC,CAACuC,kBAAF,CAAqB,IAArB,EAA2B,EAA3B,EAA+BvC,CAAC,CAACwC,cAAF,CAAiB,CACtExC,CAAC,CAACyC,mBAAF,CAAsB,KAAtB,EAA6B,CAC3BzC,CAAC,CAAC0C,kBAAF,CAAqBN,GAArB,EAA0BlB,KAAK,CAACgB,MAAM,CAACS,OAAP,CAAetC,IAAhB,CAA/B,CAD2B,EAE3BL,CAAC,CAAC0C,kBAAF,CAAqBJ,MAArB,EAA6BtC,CAAC,CAACgB,aAAF,CAAgB,EAAhB,CAA7B,CAF2B,EAG3BhB,CAAC,CAAC0C,kBAAF,CAAqBxC,CAAC,CAAC0C,MAAvB,EAA+B5C,CAAC,CAACsB,gBAAF,CAAmBc,GAAnB,EAAwBlC,CAAC,CAAC0C,MAA1B,CAA/B,CAH2B,EAI3B5C,CAAC,CAAC0C,kBAAF,CAAqBxC,CAAC,CAAC2C,KAAvB,EAA8B7C,CAAC,CAAC8C,cAAF,CAAiB,CAAjB,CAA9B,CAJ2B,EAK3B9C,CAAC,CAAC0C,kBAAF,CAAqB/B,GAArB,CAL2B,EAM3BX,CAAC,CAAC0C,kBAAF,CAAqBxC,CAAC,CAAC6C,GAAvB,CAN2B,CAA7B,CADsE,EAStE/C,CAAC,CAACgD,YAAF,CACE,IADF,EAEEhD,CAAC,CAACgC,gBAAF,CAAmB,GAAnB,EAAwB9B,CAAC,CAAC2C,KAA1B,EAAiC3C,CAAC,CAAC0C,MAAnC,CAFF,EAGE5C,CAAC,CAACiD,gBAAF,CAAmB,IAAnB,EAAyB/C,CAAC,CAAC2C,KAA3B,CAHF,EAIE7C,CAAC,CAACwC,cAAF,CAAiB,CACfxC,CAAC,CAACkD,mBAAF,CAAsBlD,CAAC,CAACmD,oBAAF,CAAuB,GAAvB,EAA4BxC,GAA5B,EAAiCT,CAAC,CAAC2C,KAAnC,CAAtB,CADe,EAEf7C,CAAC,CAACkD,mBAAF,CAAsBlD,CAAC,CAACmD,oBAAF,CAAuB,GAAvB,EAA4BjD,CAAC,CAAC6C,GAA9B,EAAmC7C,CAAC,CAAC2C,KAArC,CAAtB,CAFe,EAGf7C,CAAC,CAACkD,mBAAF,CAAsBlD,CAAC,CAACmD,oBAAF,CAAuB,IAAvB,EAA6Bb,MAA7B,EAAqCV,gBAAgB,CAACwB,OAAO,CAAClB,MAAM,CAACmB,IAAR,CAAR,CAArD,CAAtB,CAHe,CAAjB,CAJF,CATsE,EAmBtErD,CAAC,CAACsD,eAAF,CAAkBhB,MAAlB,CAnBsE,CAAjB,CAA/B,CAAjB,EAoBF,EApBE,CAAP;AAqBD;;AAED,MAAMiB,UAAU,GAAG;AACjBC,EAAAA,aAAa,CAACtB,MAAD,EAAS;AACpB,WAAOlC,CAAC,CAACgB,aAAF,CAAgBkB,MAAM,CAACuB,KAAvB,CAAP;AACD,GAHgB;;AAIjBC,EAAAA,gBAAgB,CAACxB,MAAD,EAAS;AACvB,UAAM7B,IAAI,GAAG6B,MAAM,CAAC7B,IAApB;;AACA,QAAIA,IAAI,KAAK,OAAb,EAAsB;AACpB,aAAOH,CAAC,CAACqB,OAAT;AACD;;AACD,QAAIlB,IAAI,KAAK,MAAb,EAAqB;AACnB,aAAOH,CAAC,CAAC6C,GAAT;AACD;;AACD,QAAI1C,IAAI,KAAK,QAAb,EAAuB;AACrB,aAAOH,CAAC,CAAC2C,KAAT;AACD;;AACD,QAAIxC,IAAI,KAAK,QAAb,EAAuB;AACrB,aAAOL,CAAC,CAACgC,gBAAF,CAAmB,KAAnB,EAA0B9B,CAAC,CAAC2C,KAA5B,EAAmC7C,CAAC,CAAC8C,cAAF,CAAiB,CAAjB,CAAnC,CAAP;AACD;;AACD,QAAIzC,IAAI,KAAK,OAAb,EAAsB;AACpB,aAAOL,CAAC,CAACgC,gBAAF,CAAmB,KAAnB,EAA0B9B,CAAC,CAAC2C,KAA5B,EAAmC7C,CAAC,CAACgC,gBAAF,CACxC,GADwC,EAExC9B,CAAC,CAAC0C,MAFsC,EAGxC5C,CAAC,CAAC8C,cAAF,CAAiB,CAAjB,CAHwC,CAAnC,CAAP;AAKD;;AAED,WAAO5B,KAAK,CAACb,IAAD,CAAZ;AACD,GA3BgB;;AA4BjBsD,EAAAA,gBAAgB,CAACzB,MAAD,EAAS;AACvB,QAAI/B,OAAO,CAACgB,MAAZ,EAAoB;AAClB,aAAOnB,CAAC,CAACyB,cAAF,CAAiBzB,CAAC,CAACsB,gBAAF,CACtBpB,CAAC,CAAC0D,OADoB,EAEtB5D,CAAC,CAACgB,aAAF,CAAgBkB,MAAM,CAAC2B,UAAvB,CAFsB,EAGtB,IAHsB,CAAjB,EAIJT,OAAO,CAAClB,MAAM,CAAC4B,IAAR,CAJH,CAAP;AAKD;;AAED,WAAO9D,CAAC,CAACyB,cAAF,CAAiBvB,CAAC,CAAC6D,MAAnB,EAA2B,CAChC7D,CAAC,CAACqB,OAD8B,EAEhCrB,CAAC,CAAC0D,OAF8B,EAGhC5D,CAAC,CAACgB,aAAF,CAAgBkB,MAAM,CAAC2B,UAAvB,CAHgC,EAIhC7D,CAAC,CAACgE,eAAF,CAAkBZ,OAAO,CAAClB,MAAM,CAAC4B,IAAR,CAAzB,CAJgC,CAA3B,CAAP;AAMD,GA3CgB;;AA4CjBG,EAAAA,MAAM,CAAC/B,MAAD,EAASgC,UAAT,EAAqB;AACzB,QAAIC,IAAI,GAAGZ,UAAU,CAACrB,MAAM,CAACiC,IAAP,CAAYC,SAAb,CAAV,CAAkClC,MAAM,CAACiC,IAAzC,CAAX;;AACA,QAAIjC,MAAM,CAACmC,GAAX,EAAgB;AACdF,MAAAA,IAAI,GAAGnE,CAAC,CAACsE,eAAF,CAAkB,GAAlB,EAAuBH,IAAvB,EAA6B,IAA7B,CAAP;AACD;;AAED,QAAII,SAAS,GAAGvE,CAAC,CAACgB,aAAF,CAAgB,EAAhB,CAAhB;;AACA,QAAIkD,UAAU,IAAIA,UAAU,CAACE,SAAX,KAAyB,MAA3C,EAAmD;AACjDG,MAAAA,SAAS,GAAG3C,gBAAgB,CAACwB,OAAO,CAACc,UAAU,CAACb,IAAZ,CAAR,CAA5B;AAEAa,MAAAA,UAAU,CAACM,QAAX,GAAsB,IAAtB;AACD;;AAED,WAAOxE,CAAC,CAACyE,qBAAF,CAAwBN,IAAxB,EAA8BvC,gBAAgB,CAACwB,OAAO,CAAClB,MAAM,CAACmB,IAAR,CAAR,CAA9C,EAAsEkB,SAAtE,CAAP;AACD,GA1DgB;;AA2DjBG,EAAAA,QAAQ,CAACxC,MAAD,EAAS;AACf,QAAI/B,OAAO,CAACgB,MAAZ,EAAoB;AAClB,YAAMA,MAAM,GAAGc,UAAU,CAACC,MAAD,CAAzB;AACAf,MAAAA,MAAM,CAACwD,IAAP,GAAczC,MAAM,CAACyC,IAArB;AACAxD,MAAAA,MAAM,CAACyD,SAAP,GAAmB1C,MAAM,CAAC0C,SAA1B;AAEA,aAAOzD,MAAP;AACD;;AAED,UAAMR,GAAG,GAAGT,CAAC,CAACe,KAAF,CAAQiB,MAAM,CAACC,UAAf,CAAZ;AAEA,UAAM0C,IAAI,GAAG7E,CAAC,CAACyB,cAAF,CAAiBvB,CAAC,CAAC4E,IAAnB,EAAyB,CACpC5D,KAAK,CAACgB,MAAM,CAACS,OAAP,CAAetC,IAAhB,CAD+B,EAEpCL,CAAC,CAACuC,kBAAF,CAAqBrC,CAAC,CAAC6E,IAAvB,EAA6B,CAC3BpE,GAD2B,EAE3BT,CAAC,CAAC2C,KAFyB,EAG3B3C,CAAC,CAAC0C,MAHyB,CAA7B,EAIG5C,CAAC,CAACwC,cAAF,CAAiB,CAClBxC,CAAC,CAACyC,mBAAF,CAAsB,KAAtB,EAA6B,CAACzC,CAAC,CAAC0C,kBAAF,CAAqBxC,CAAC,CAAC6C,GAAvB,EAA4BpC,GAA5B,CAAD,CAA7B,CADkB,EAElBX,CAAC,CAACsD,eAAF,CAAkB1B,gBAAgB,CAACwB,OAAO,CAAClB,MAAM,CAACmB,IAAR,CAAR,CAAlC,CAFkB,CAAjB,CAJH,CAFoC,CAAzB,CAAb;AAWAwB,IAAAA,IAAI,CAACF,IAAL,GAAYzC,MAAM,CAACyC,IAAnB;AACAE,IAAAA,IAAI,CAACD,SAAL,GAAiB1C,MAAM,CAAC0C,SAAxB;AAEA,WAAOC,IAAP;AACD,GArFgB;;AAsFjBG,EAAAA,IAAI,CAAC9C,MAAD,EAAS;AACX,WAAOlC,CAAC,CAACgB,aAAF,CAAgBkB,MAAM,CAACuB,KAAvB,CAAP;AACD,GAxFgB;;AAyFjBwB,EAAAA,WAAW,CAAC/C,MAAD,EAAS;AAClB,WAAOqB,UAAU,CAACrB,MAAM,CAACgD,UAAP,CAAkBd,SAAnB,CAAV,CAAwClC,MAAM,CAACgD,UAA/C,EAA2DhD,MAAM,CAACiD,GAAlE,CAAP;AACD,GA3FgB;;AA4FjBC,EAAAA,eAAe,CAAClD,MAAD,EAAS;AACtB,WAAOlC,CAAC,CAACyB,cAAF,CACLvB,CAAC,CAACmF,MADG,EAEL,CAAC9B,UAAU,CAAC0B,WAAX,CAAuB/C,MAAvB,CAAD,CAFK,CAAP;AAID;;AAjGgB,CAAnB;AAoGA;;;;;;AAKA,SAASkB,OAAT,CAAiBC,IAAjB,EAAuB;AACrB,QAAMiC,QAAQ,GAAG,EAAjB;AACA,QAAMC,GAAG,GAAGlC,IAAI,CAACtB,MAAjB;;AACA,OAAK,IAAID,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGyD,GAApB,EAAyBzD,CAAC,IAAI,CAA9B,EAAiC;AAC/B,UAAMI,MAAM,GAAGmB,IAAI,CAACvB,CAAD,CAAnB;;AACA,QAAI,CAACI,MAAM,CAACsC,QAAZ,EAAsB;AACpBc,MAAAA,QAAQ,CAACE,IAAT,CAAcjC,UAAU,CAACrB,MAAM,CAACkC,SAAR,CAAV,CAA6BlC,MAA7B,EAAqC,GAAGmB,IAAI,CAACoC,KAAL,CAAW3D,CAAC,GAAG,CAAf,CAAxC,CAAd;AACD;AACF;;AAED,SAAOwD,QAAP;AACD;AAED;;;;;;;AAKA,SAASI,QAAT,CAAkBC,MAAlB,EAA0BC,IAA1B,EAAgC;AAC9BzF,EAAAA,OAAO,GAAGyF,IAAV;AACA,QAAMN,QAAQ,GAAGlC,OAAO,CAACuC,MAAD,CAAxB;AAEA,SAAO3F,CAAC,CAAC6F,mBAAF,CAAsB3F,CAAC,CAAC4F,QAAxB,EAAkC5F,CAAC,CAAC6F,aAApC,EAAmD/F,CAAC,CAACwC,cAAF,CAAiB,CACzExC,CAAC,CAACsD,eAAF,CAAkB1B,gBAAgB,CAAC0D,QAAD,CAAlC,CADyE,CAAjB,CAAnD,CAAP;AAGD;;AAEDI,QAAQ,CAACnC,UAAT,GAAsBA,UAAtB;AAEAyC,MAAM,CAACC,OAAP,GAAiBP,QAAjB","sourcesContent":["'use strict';\n\nconst t = require('babel-types');\n\nconst c = require('./constants');\n\nlet options;\n\n// Helpers for constructing AST nodes\nfunction PathExpression(path) {\n  const iterPattern = /^(.*)\\[(\\d+)]$/;\n  const paths = path.split('.').reduce((prev, key) => {\n    const matches = key.match(iterPattern);\n    if (matches) {\n      const [, rest, index] = matches;\n      return [...prev, t.stringLiteral(rest), c.KEY_I(index)];\n    }\n    return [...prev, t.stringLiteral(key)];\n  }, []);\n\n  return paths;\n}\nfunction Guard(path) {\n  const paths = PathExpression(path);\n\n  if (options.unsafe === true) {\n    return paths.reduce((out, p) => t.memberExpression(out, p, true), c.CONTEXT);\n  }\n\n  // precompile path expressions into\n  //   context && context['prop'] && context['prop'][5] ...\n  let last = c.CONTEXT;\n  return t.callExpression(c.GUARD, [\n    paths.reduce((out, p) => {\n      last = t.memberExpression(last, p, true);\n      return t.logicalExpression('&&', out, last);\n    }, last),\n  ]);\n}\n// take an array of string expressions\n// and convert it to direct concatenation like this\n//    a + b + c + d\nfunction ConcatStringList(outputs) {\n  let out = outputs[0];\n\n  for (let i = 1; i < outputs.length; i += 1) {\n    out = t.binaryExpression('+', out, outputs[i]);\n  }\n\n  return out;\n}\n// inline iteration unsafely\n// only supports iterating over arrays-likes\nfunction UnsafeIter(branch) {\n  const key = c.KEY_I(branch.iterSuffix);\n\n  const arr = t.identifier('arr');\n  const output = t.identifier('output');\n\n  return t.callExpression(t.functionExpression(null, [], t.blockStatement([\n    t.variableDeclaration('var', [\n      t.variableDeclarator(arr, Guard(branch.subject.path)),\n      t.variableDeclarator(output, t.stringLiteral('')),\n      t.variableDeclarator(c.LENGTH, t.memberExpression(arr, c.LENGTH)),\n      t.variableDeclarator(c.INDEX, t.numericLiteral(0)),\n      t.variableDeclarator(key),\n      t.variableDeclarator(c.KEY),\n    ]),\n    t.forStatement(\n      null,\n      t.binaryExpression('<', c.INDEX, c.LENGTH),\n      t.updateExpression('++', c.INDEX),\n      t.blockStatement([\n        t.expressionStatement(t.assignmentExpression('=', key, c.INDEX)),\n        t.expressionStatement(t.assignmentExpression('=', c.KEY, c.INDEX)),\n        t.expressionStatement(t.assignmentExpression('+=', output, ConcatStringList(compile(branch.body)))),\n      ]),\n    ),\n    t.returnStatement(output),\n  ])), []);\n}\n\nconst transforms = {\n  StringLiteral(branch) {\n    return t.stringLiteral(branch.value);\n  },\n  SimpleExpression(branch) {\n    const path = branch.path;\n    if (path === '@root') {\n      return c.CONTEXT;\n    }\n    if (path === '@key') {\n      return c.KEY;\n    }\n    if (path === '@index') {\n      return c.INDEX;\n    }\n    if (path === '@first') {\n      return t.binaryExpression('===', c.INDEX, t.numericLiteral(0));\n    }\n    if (path === '@last') {\n      return t.binaryExpression('===', c.INDEX, t.binaryExpression(\n        '-',\n        c.LENGTH,\n        t.numericLiteral(1)\n      ));\n    }\n\n    return Guard(path);\n  },\n  HelperExpression(branch) {\n    if (options.unsafe) {\n      return t.callExpression(t.memberExpression(\n        c.HELPERS,\n        t.stringLiteral(branch.helperName),\n        true,\n      ), compile(branch.args));\n    }\n\n    return t.callExpression(c.HELPER, [\n      c.CONTEXT,\n      c.HELPERS,\n      t.stringLiteral(branch.helperName),\n      t.arrayExpression(compile(branch.args)),\n    ]);\n  },\n  OpenIf(branch, nextBranch) {\n    let test = transforms[branch.test.tokenType](branch.test);\n    if (branch.not) {\n      test = t.unaryExpression('!', test, true);\n    }\n\n    let alternate = t.stringLiteral('');\n    if (nextBranch && nextBranch.tokenType === 'Else') {\n      alternate = ConcatStringList(compile(nextBranch.body));\n\n      nextBranch.skipThis = true;\n    }\n\n    return t.conditionalExpression(test, ConcatStringList(compile(branch.body)), alternate);\n  },\n  OpenIter(branch) {\n    if (options.unsafe) {\n      const unsafe = UnsafeIter(branch);\n      unsafe.name = branch.name;\n      unsafe.cleanName = branch.cleanName;\n\n      return unsafe;\n    }\n\n    const key = c.KEY_I(branch.iterSuffix);\n\n    const iter = t.callExpression(c.ITER, [\n      Guard(branch.subject.path),\n      t.functionExpression(c.EACH, [\n        key,\n        c.INDEX,\n        c.LENGTH,\n      ], t.blockStatement([\n        t.variableDeclaration('var', [t.variableDeclarator(c.KEY, key)]),\n        t.returnStatement(ConcatStringList(compile(branch.body))),\n      ])),\n    ]);\n    iter.name = branch.name;\n    iter.cleanName = branch.cleanName;\n\n    return iter;\n  },\n  Text(branch) {\n    return t.stringLiteral(branch.value);\n  },\n  RawMustache(branch) {\n    return transforms[branch.expression.tokenType](branch.expression, branch.raw);\n  },\n  EscapedMustache(branch) {\n    return t.callExpression(\n      c.ESCAPE,\n      [transforms.RawMustache(branch)]\n    );\n  },\n};\n\n/**\n * Transform a template syntax tree into a Babylon AST\n * @param {object[]} body\n * @returns {object[]}\n */\nfunction compile(body) {\n  const compiled = [];\n  const len = body.length;\n  for (let i = 0; i < len; i += 1) {\n    const branch = body[i];\n    if (!branch.skipThis) {\n      compiled.push(transforms[branch.tokenType](branch, ...body.slice(i + 1)));\n    }\n  }\n\n  return compiled;\n}\n\n/**\n * Transform a template syntax tree into a Babylon AST\n * @param {object[]} parsed\n * @returns {object}\n */\nfunction compiler(parsed, opts) {\n  options = opts;\n  const compiled = compile(parsed);\n\n  return t.functionDeclaration(c.COMPILED, c.runtimeParams, t.blockStatement([\n    t.returnStatement(ConcatStringList(compiled)),\n  ]));\n}\n\ncompiler.transforms = transforms;\n\nmodule.exports = compiler;\n"],"file":"compiler.js"}